# Oh my tmux! local overrides
# https://github.com/gpakosz/.tmux
#
# Customizations for Kyle's dotfiles
# All settings here override the defaults in .tmux.conf

# -- display -------------------------------------------------------------------

# Ghostty supports true color natively
tmux_conf_24b_colour=true

# -- windows & panes -----------------------------------------------------------

# Retain current path when splitting panes (default: true)
tmux_conf_new_pane_retain_current_path=true

# Retain current path when creating new windows
tmux_conf_new_window_retain_current_path=true

# -- theming -------------------------------------------------------------------

# ANSI passthrough — tmux inherits colors from the terminal palette.
# When the-themer switches themes, tmux follows automatically.
tmux_conf_theme_colour_1="colour0"     # bg (black)
tmux_conf_theme_colour_2="colour8"     # dark accent (bright black)
tmux_conf_theme_colour_3="colour8"     # muted text
tmux_conf_theme_colour_4="colour14"    # highlight (bright cyan)
tmux_conf_theme_colour_5="colour11"    # active accent (bright yellow)
tmux_conf_theme_colour_6="colour0"     # bg
tmux_conf_theme_colour_7="colour15"    # fg (bright white)
tmux_conf_theme_colour_8="colour0"     # bg
tmux_conf_theme_colour_9="colour11"    # active accent
tmux_conf_theme_colour_10="colour13"   # alert (bright magenta)
tmux_conf_theme_colour_11="colour10"   # success (bright green)
tmux_conf_theme_colour_12="colour8"    # muted
tmux_conf_theme_colour_13="colour15"   # fg
tmux_conf_theme_colour_14="colour0"    # bg
tmux_conf_theme_colour_15="colour0"    # bg
tmux_conf_theme_colour_16="colour1"    # error (red)
tmux_conf_theme_colour_17="colour15"   # fg

# Powerline separators (MesloLGS Nerd Font has these glyphs)
tmux_conf_theme_left_separator_main='\uE0B0'
tmux_conf_theme_left_separator_sub='\uE0B1'
tmux_conf_theme_right_separator_main='\uE0B2'
tmux_conf_theme_right_separator_sub='\uE0B3'

# Minimal status bar — optimized for ~45 char phone width (Moshi on iPhone 13 Mini)
#
# Budget: ~7 left + ~32 windows + ~6 right = 45 chars
# Mouse indicator removed: always on, never changes, wasted 2 chars.
# Pairing/sync only appear when active (no space reservation).
# Prefix reserves 3 chars (symbol + space) even when inactive to prevent bar shift.
tmux_conf_theme_status_left=" #S "
tmux_conf_theme_status_right=" #{prefix}#{pairing}#{synchronized} "

# Prefix indicator — bright yellow block, unmissable on a phone
tmux_conf_theme_prefix="^A"
tmux_conf_theme_prefix_fg="colour0"
tmux_conf_theme_prefix_bg="colour11"
tmux_conf_theme_prefix_attr="bold"

# Pairing indicator — orange block when Mac + phone both attached
# Uses session_many_attached: only visible with 2+ clients
tmux_conf_theme_pairing="2+"
tmux_conf_theme_pairing_fg="colour0"
tmux_conf_theme_pairing_bg="colour3"
tmux_conf_theme_pairing_attr="bold"

# Synchronized panes — red warning, typing goes to ALL panes
tmux_conf_theme_synchronized="SY"
tmux_conf_theme_synchronized_fg="colour0"
tmux_conf_theme_synchronized_bg="colour1"
tmux_conf_theme_synchronized_attr="bold"

# Compact window format with zoom flag
# Names truncated to 8 chars to prevent overflow on narrow screens.
# Z appended when pane is zoomed — critical for agent supervision.
tmux_conf_theme_window_status_format="#I:#{=8:window_name}#{?window_zoomed_flag,Z,}"
tmux_conf_theme_window_status_current_format="#I:#{=8:window_name}#{?window_zoomed_flag,Z,}"

# -- clipboard -----------------------------------------------------------------

# Copy to macOS clipboard automatically in copy mode
tmux_conf_copy_to_os_clipboard=true

# -- user customizations -------------------------------------------------------

# History (100k for long agent output sessions)
set -g history-limit 100000

# Per-client viewport sizing for grouped sessions
# Phone gets phone-sized viewport, Mac gets Mac-sized, same windows
set -g window-size latest

# Window title propagation for Moshi
# Claude Code auto-sets terminal titles; this format passes them through
set -g set-titles-string "#I: #W"

# Mouse support
set -g mouse on

# Zero escape delay (critical for vi-mode responsiveness)
set -sg escape-time 0

# Vi mode for copy/status
set -g mode-keys vi
set -g status-keys vi

# Focus events (helps editors detect window focus changes)
set -g focus-events on

# Allow image passthrough
set -g allow-passthrough on

# -- tpm -----------------------------------------------------------------------

# Disable auto-updating plugins on launch (opt in when needed)
tmux_conf_update_plugins_on_launch=false
tmux_conf_update_plugins_on_reload=true

# Uncomment plugins as needed:
#set -g @plugin 'tmux-plugins/tmux-resurrect'
#set -g @plugin 'tmux-plugins/tmux-continuum'
#set -g @continuum-restore 'on'
